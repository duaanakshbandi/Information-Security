#!/usr/bin/env python3
from pwn import *
from string import *

context.log_level = 'error'

hackletStart = time.time()

# Run process
io = process("./main.elf")

io.recvline()

correctPassword = ""
passwordLength = 8
possibleChars = ascii_lowercase + ascii_uppercase + digits + punctuation

gotTheFlag = False

for i in range(passwordLength):
    result = {key: 0 for key in possibleChars}
    for _ in range(6):
        # can lower the number here for faster execution but lower guarantee for correct result...
        for char in possibleChars:
            input = (correctPassword + char).encode('UTF-8')
            start = time.time()
            io.sendline(input)
            response = io.recvline()
            end = time.time()
            result[char] += end - start

            if response ==  b'> Provided password was correct\n':
                gotTheFlag = True
                break
        if gotTheFlag:
            break

    correctChar = sorted(result, key=result.get, reverse=True)[0]
    correctPassword += correctChar

# Read the flag using Regex
r = io.recvall().decode("ascii")
flag_regex = re.compile("(InfoSec{.+[^}]})")
flag = flag_regex.findall(r)
flag = flag[0]
print(flag)

hackletEnd = time.time()
result[char] += hackletEnd - hackletStart

#print(hackletEnd)