#!/usr/bin/env python3
from pwn import *
import re

context.log_level = 'error'

# Run process
io = process("./main.elf")

# Unencrypted
io.sendline(b'infosecaaaaaaaaa')

# Encrypted
io.sendline(b'/.>) 3%".' + b"' 70-+0")

# Do the flag reading thingy with REEEEEEEEEEE (Regular Expression stolen from professor MartinSchwarzl, all credits go to him)
r = io.recvall().decode('ascii', errors='ignore')
flag_regex = re.compile('(InfoSec{.+[^}]})')
flag = flag_regex.findall(r)
flag = flag[0]
print(flag)